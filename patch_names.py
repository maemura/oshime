#!/usr/bin/env python3
"""stocks_data.json内の英語銘柄名を日本語に修正"""
import json

# 英語→日本語名マッピング（主要銘柄）
NAME_JP = {
    "1332": "ニッスイ", "1605": "INPEX", "1801": "大成建設",
    "1802": "大林組", "1803": "清水建設", "1808": "長谷工コーポ",
    "1812": "鹿島建設", "1925": "大和ハウス", "1928": "積水ハウス",
    "2002": "日清製粉G", "2269": "明治HD", "2413": "エムスリー",
    "2502": "アサヒGHD", "2503": "キリンHD", "2801": "キッコーマン",
    "2802": "味の素", "2914": "JT", "3086": "Jフロント",
    "3099": "三越伊勢丹", "3382": "セブン＆アイ", "3402": "東レ",
    "3407": "旭化成", "4063": "信越化学", "4188": "三菱ケミカルG",
    "4452": "花王", "4502": "武田薬品", "4503": "アステラス製薬",
    "4507": "塩野義製薬", "4519": "中外製薬", "4523": "エーザイ",
    "4543": "テルモ", "4568": "第一三共", "4578": "大塚HD",
    "4661": "OLC", "4689": "Zホールディングス", "4751": "サイバーエージェント",
    "4755": "楽天G", "4901": "富士フイルム", "4911": "資生堂",
    "5020": "ENEOS", "5019": "出光興産", "5101": "横浜ゴム",
    "5108": "ブリヂストン", "5201": "AGC", "5332": "TOTO",
    "5401": "日本製鉄", "5406": "神戸製鋼", "5411": "JFE HD",
    "5713": "住友金属鉱山", "5802": "住友電工", "5803": "フジクラ",
    "5831": "しずおかFG", "5901": "東洋製罐", "5938": "LIXIL",
    "6098": "リクルート", "6146": "ディスコ", "6178": "日本郵政",
    "6273": "SMC", "6301": "コマツ", "6326": "クボタ",
    "6361": "荏原製作所", "6367": "ダイキン", "6471": "日本精工",
    "6501": "日立", "6502": "東芝", "6503": "三菱電機",
    "6504": "富士電機", "6506": "安川電機", "6526": "ソシオネクスト",
    "6594": "日本電産", "6645": "オムロン", "6701": "NEC",
    "6702": "富士通", "6723": "ルネサス", "6724": "セイコーエプソン",
    "6752": "パナソニック", "6758": "ソニーG", "6857": "アドバンテスト",
    "6861": "キーエンス", "6902": "デンソー", "6920": "レーザーテック",
    "6954": "ファナック", "6971": "京セラ", "6976": "太陽誘電",
    "6981": "村田製作所", "7011": "三菱重工", "7012": "川崎重工",
    "7013": "IHI", "7201": "日産自動車", "7203": "トヨタ自動車",
    "7261": "マツダ", "7267": "ホンダ", "7269": "スズキ",
    "7270": "SUBARU", "7272": "ヤマハ発動機", "7309": "シマノ",
    "7532": "パンパシHD", "7741": "HOYA", "7751": "キヤノン",
    "7752": "リコー", "7832": "バンナム", "7911": "凸版印刷",
    "7912": "大日本印刷", "7951": "ヤマハ", "7974": "任天堂",
    "8001": "伊藤忠", "8002": "丸紅", "8015": "豊田通商",
    "8031": "三井物産", "8035": "東京エレクトロン", "8053": "住友商事",
    "8058": "三菱商事", "8113": "ユニ・チャーム",
    "8233": "高島屋", "8252": "丸井G",
    "8267": "イオン", "8306": "三菱UFJ", "8308": "りそなHD",
    "8309": "三井住友トラスト", "8316": "三井住友FG", "8331": "千葉銀行",
    "8354": "ふくおかFG", "8411": "みずほFG",
    "8591": "オリックス", "8593": "三菱HCキャピタル",
    "8601": "大和証券G", "8604": "野村HD",
    "8630": "SOMPO", "8725": "MS&AD", "8750": "第一生命",
    "8766": "東京海上", "8795": "T&D HD",
    "8801": "三井不動産", "8802": "三菱地所", "8830": "住友不動産",
    "9001": "東武鉄道", "9005": "東急", "9020": "JR東日本",
    "9021": "JR西日本", "9022": "JR東海", "9042": "阪急阪神HD",
    "9064": "ヤマトHD", "9101": "日本郵船", "9104": "商船三井",
    "9107": "川崎汽船", "9143": "SGホールディングス",
    "9201": "JAL", "9202": "ANA HD",
    "9432": "NTT", "9433": "KDDI", "9434": "ソフトバンク",
    "9501": "東京電力", "9502": "中部電力", "9503": "関西電力",
    "9508": "九州電力",
    "9504": "中国電力", "9505": "北陸電力", "9506": "東北電力",
    "9507": "四国電力", "9509": "北海道電力", "9531": "東京ガス", "9532": "大阪ガス",
    "9602": "東宝", "9613": "NTTデータG",
    "9735": "セコム", "9766": "コナミG", "9843": "ニトリHD",
    "9983": "ファーストリテ", "9984": "ソフトバンクG",
    "3659": "ネクソン", "3668": "コロプラ", "3765": "ガンホー",
    "2121": "mixi", "9697": "カプコン", "4443": "Sansan",
    "4478": "フリー", "3635": "コーエーテクモ", "9684": "スクエニHD",
    "8219": "青山商事", "4611": "大日本塗料", "7148": "FPG",
    "5943": "ノーリツ", "6817": "スミダコーポ", "3608": "TSI HD",
    "8185": "チヨダ", "7989": "立川ブラインド",
    "4204": "積水化学", "4205": "日本ゼオン",
    "6753": "シャープ", "7731": "ニコン",
    "8604": "野村HD",
    "7211": "三菱自動車",
}

d = json.load(open('stocks_data.json'))
fixed = 0
for s in d['stocks']:
    code = s.get('code', '')
    name = s.get('name', '')
    # 英語名の場合（ASCII文字のみ or 英大文字が多い）
    has_jp = any(ord(c) > 127 for c in name)
    if not has_jp and code in NAME_JP:
        s['name'] = NAME_JP[code]
        fixed += 1
    elif code in NAME_JP and len(name) > 20:
        # 日本語だけど長すぎる正式名（株式会社〜）を短縮
        s['name'] = NAME_JP[code]
        fixed += 1

print(f"✅ 銘柄名を日本語化: {fixed}件修正")

# 残ってる英語名を表示
still_eng = []
for s in d['stocks']:
    if not any(ord(c) > 127 for c in s.get('name', '')):
        still_eng.append(f"  {s['code']}: {s['name']}")
if still_eng:
    print(f"⚠ まだ英語名: {len(still_eng)}件")
    for e in still_eng[:20]:
        print(e)

json.dump(d, open('stocks_data.json', 'w'), ensure_ascii=False, indent=2)
